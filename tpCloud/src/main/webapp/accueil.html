<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Accueil</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <script src="https://unpkg.com/mithril/mithril.js"></script>
    

	<script>	

var petitions = {
	    list: [],
	    loadList: function() {
	        return m.request({
	            method: "GET",
	            url: "'http://localhost:8080/_ah/api/MonApi/v1/petitions'"
	        })
	        .then(function(items) {
	            petitions.list = result.items
	        	console.log("got:",result.items)
	        	m.redraw(true) // force
	        })
	    }
	}

   var PetitionView = {
		oninit: petition.loadList,
	    view: function() {
	        return m(".user-list", Petition.list.map(function(item) {
	            return m(".Petition-list-item", item.properties.name + " " + item.properties.message)
	        }))
	    },
		
    }

    var signIn = {
        function onSignIn(googleUser) {
        // Useful data for your client-side scripts:
        var profile = googleUser.getBasicProfile();
        console.log("ID: " + profile.getId()); // Don't send this directly to your server!
        console.log('Full Name: ' + profile.getName());
        console.log('Given Name: ' + profile.getGivenName());
        console.log('Family Name: ' + profile.getFamilyName());
        console.log("Image URL: " + profile.getImageUrl());
        console.log("Email: " + profile.getEmail());
        // The ID token you need to pass to your backend:
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);
      }

    }

    var affiche = {
	    view: function() {
	    	return m("main", [
	            m("h1", {class: "title"}, "accueil"),
	            m("div", {id: "box"}, m(PetitionView)),
	            m("div", {id: "form"}, m(Form)),
	            m("button", {onclick: function() {count++}}, count + " clicks"),
	        ])
	    }
	}

m.mount(document.body, affiche)	

</script>
</body>
</html>